name: Deploy to Production

on:
  workflow_dispatch:
      inputs:
            version:
                    description: 'Version to deploy (format: X.Y.Z)'
                            required: true
                                    type: string

                                    jobs:
                                      deploy:
                                          runs-on: ubuntu-latest
                                              steps:
                                                    - name: Checkout code
                                                            uses: actions/checkout@v3

                                                                        - name: Log deployment start
                                                                                run: echo "Starting deployment of version ${{ inputs.version }}"

                                                                                            - name: Send Slack notification
                                                                                                    uses: slackapi/slack-github-action@v1.24.0
                                                                                                            with:
                                                                                                                      payload: |
                                                                                                                                  {
                                                                                                                                                "text": "Production Deployment Request",
                                                                                                                                                              "blocks": [
                                                                                                                                                                              {
                                                                                                                                                                                                "type": "section",
                                                                                                                                                                                                                  "text": {
                                                                                                                                                                                                                                      "type": "mrkdwn",
                                                                                                                                                                                                                                                          "text": "*Deploy to Production - Version ${{ inputs.version }}*\n\nRequesting approval to deploy version ${{ inputs.version }} to production."
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                                                                                                              "type": "actions",
                                                                                                                                                                                                                                                                                                                                                "elements": [
                                                                                                                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                                                                                                                                          "type": "button",
                                                                                                                                                                                                                                                                                                                                                                                                                "text": {
                                                                                                                                                                                                                                                                                                                                                                                                                                        "type": "plain_text",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                "text": "Approve"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "value": "approve",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "style": "primary"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "type": "button",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "text": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "type": "plain_text",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "text": "Deny"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "value": "deny",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "style": "danger"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                env:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - name: Deployment complete
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        run: echo "Deployment workflow triggered for version ${{ inputs.version }}"
